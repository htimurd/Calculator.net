<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Calculator.net - Dev Edition</title>
    <style>
        :root { --orange: #ff9500; --red: #ff3b30; --green: #28cd41; --gray: #555; }
        
        body {
            background-color: #000; display: flex; justify-content: flex-start;
            align-items: center; height: 100vh; margin: 0; padding-left: 50px;
            font-family: 'Segoe UI', sans-serif; color: white; overflow: hidden;
        }

        /* Анимации */
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-8px); } 75% { transform: translateX(8px); } }
        .shake { animation: shake 0.3s ease-in-out; }

        /* Профиль и Меню */
        .top-menu { position: absolute; top: 25px; right: 30px; display: flex; gap: 15px; align-items: center; }
        .buy-zone { display: flex; flex-direction: column; align-items: center; }
        .current-status { font-size: 10px; color: #555; margin-top: 4px; text-transform: uppercase; letter-spacing: 1px; }

        .profile-box { text-align: right; display: none; }
        .profile-name { font-weight: bold; font-size: 16px; color: white; }
        .profile-email { font-size: 11px; color: #777; display: block; margin-top: -2px; }
        .btn-logout { background: none; border: none; color: var(--red); font-size: 10px; cursor: pointer; text-decoration: underline; padding: 0; }
        .btn-dev { background: none; border: 1px solid #333; color: #555; font-size: 10px; padding: 4px 8px; cursor: pointer; border-radius: 3px; }

        .nav-btn { padding: 10px 20px; border-radius: 6px; border: 1px solid #444; cursor: pointer; background: transparent; color: white; transition: 0.3s; }
        .btn-buy { background-color: var(--orange) !important; color: #000 !important; font-weight: bold; border: none !important; }

        /* Калькулятор */
        .calc-wrapper { width: 320px; }
        #display { width: 100%; height: 90px; background: transparent; border: 2px solid var(--orange); color: white; font-size: 42px; text-align: right; margin-bottom: 25px; padding: 15px; box-sizing: border-box; border-radius: 12px; outline: none; }
        .buttons { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
        .calc-btn { height: 65px; border-radius: 10px; border: 1px solid #333; background: #1a1a1a; color: white; font-size: 22px; cursor: pointer; opacity: 0.4; transition: 0.2s; }
        .unlocked { opacity: 1; }
        .op { color: var(--orange); }
        .equal { background: #333; color: var(--orange); font-weight: bold; }
        .equal.unlocked { background: var(--orange) !important; color: black !important; }

        /* Модалки */
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.9); justify-content: center; align-items: center; }
        .modal-content { background: #111; padding: 30px; border-radius: 15px; border: 1px solid var(--orange); width: 380px; position: relative; text-align: center; }
        
        .modal-console { width: 90% !important; max-width: 1200px; height: 85vh; display: flex; flex-direction: column; }
        #devConsole { flex-grow: 1; background: #000; color: #fff; font-family: 'Consolas', monospace; text-align: left; font-size: 14px; padding: 15px; overflow-y: auto; border: 1px solid #222; }
        .cmd-line { display: flex; background: #000; padding: 10px; border: 1px solid #222; border-top: none; align-items: center; }
        .cmd-prefix { color: var(--orange); margin-right: 10px; font-weight: bold; }
        .cmd-input { background: transparent; border: none; color: #fff; flex-grow: 1; outline: none; font-family: monospace; }

        .close-x { position: absolute; right: 20px; top: 15px; color: #555; cursor: pointer; font-size: 28px; }

        .auth-btn { width: 100%; padding: 12px; background: var(--orange); border: none; color: black; font-weight: bold; margin: 10px 0; cursor: pointer; border-radius: 5px; }
        .auth-btn:disabled { background: #222 !important; color: var(--gray) !important; cursor: not-allowed; border: 1px dashed #444; }
        .btn-cancel-red { background: var(--red) !important; color: white !important; margin-top: 15px; }

        .proc-status { color: #fff; font-size: 16px; min-height: 110px; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; line-height: 1.6; margin-bottom: 10px; }
        .final-btns { display: none; flex-direction: column; gap: 10px; margin-top: 20px; }

        .auth-input { width: 100%; padding: 12px; margin: 6px 0; background: #222; border: 1px solid #444; color: white; border-radius: 5px; box-sizing: border-box; outline: none; }
        .link-text { color: #888; font-size: 13px; margin-top: 15px; cursor: pointer; }
        .link-text span { color: var(--orange); font-weight: bold; text-decoration: underline; }

        .footer-text { position: absolute; bottom: 30px; right: 40px; color: #444; font-size: 20px; user-select: none; }
    </style>
</head>
<body>

    <div class="top-menu">
        <button id="devBtn" class="btn-dev" style="display:none;" onclick="openModal('devModal')">ДЛЯ РАЗРАБОТЧИКОВ</button>
        <div class="buy-zone">
            <button class="nav-btn btn-buy" onclick="openModal('buyModal')">Улучшить Тариф</button>
            <div id="statusLabel" class="current-status">Тариф: NONE</div>
        </div>
        <button id="loginBtn" class="nav-btn" onclick="openModal('loginModal')">Войти</button>
        <div id="profileBox" class="profile-box">
            <span id="pName" class="profile-name">User</span>
            <span id="pEmail" class="profile-email">email@gmail.com</span>
            <button class="btn-logout" onclick="location.reload()">Выйти</button>
        </div>
    </div>

    <div class="calc-wrapper" id="calcMain">
        <input type="text" id="display" readonly placeholder="0">
        <div class="buttons">
            <button id="btn-C" class="calc-btn op" data-tier="super" onclick="press('C')">C</button>
            <button id="btn-del" class="calc-btn op" data-tier="super" onclick="press('del')">←</button>
            <button id="btn-perc" class="calc-btn op" data-tier="super" onclick="press('perc')">%</button>
            <button id="btn-div" class="calc-btn op" data-tier="super" onclick="press('div')">÷</button>
            <button id="btn-7" class="calc-btn" data-tier="standart" onclick="press('7')">7</button>
            <button id="btn-8" class="calc-btn" data-tier="standart" onclick="press('8')">8</button>
            <button id="btn-9" class="calc-btn" data-tier="standart" onclick="press('9')">9</button>
            <button id="btn-mul" class="calc-btn op" data-tier="super" onclick="press('mul')">×</button>
            <button id="btn-4" class="calc-btn" data-tier="standart" onclick="press('4')">4</button>
            <button id="btn-5" class="calc-btn" data-tier="standart" onclick="press('5')">5</button>
            <button id="btn-6" class="calc-btn" data-tier="standart" onclick="press('6')">6</button>
            <button id="btn-sub" class="calc-btn op" data-tier="pro" onclick="press('sub')">-</button>
            <button id="btn-1" class="calc-btn" data-tier="standart" onclick="press('1')">1</button>
            <button id="btn-2" class="calc-btn" data-tier="standart" onclick="press('2')">2</button>
            <button id="btn-3" class="calc-btn" data-tier="standart" onclick="press('3')">3</button>
            <button id="btn-add" class="calc-btn op" data-tier="pro" onclick="press('add')">+</button>
            <button id="btn-0" class="calc-btn" data-tier="standart" onclick="press('0')" style="grid-column: span 2;">0</button>
            <button id="btn-dot" class="calc-btn" data-tier="standart" onclick="press('dot')">.</button>
            <button id="btn-equal" class="calc-btn equal" data-tier="mega" onclick="press('equal')">=</button>
        </div>
    </div>

    <!-- Модалка Входа -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close-x" onclick="closeModal('loginModal')">&times;</span>
            <h2 id="authTitle">Авторизация</h2>
            <input type="email" id="emailInp" class="auth-input" placeholder="E-mail">
            <input type="password" id="passInp" class="auth-input" placeholder="Пароль">
            <button class="auth-btn" onclick="fakeLogin()">Продолжить</button>
            <p class="link-text" onclick="toggleAuth()">Нет аккаунта? <span>Создать</span></p>
        </div>
    </div>

    <!-- Модалка Покупки -->
    <div id="buyModal" class="modal">
        <div class="modal-content">
            <span class="close-x" onclick="closeModal('buyModal')">&times;</span>
            <h2>Выбор тарифа</h2>
            <div id="procZone" class="proc-status">Выберите план для разблокировки функций</div>
            <div id="tierList">
                <button class="auth-btn" onclick="startBuy('ULTIMATE MEGA PACK', 'mega')">ULTIMATE MEGA (Все кнопки) - $99</button>
                <button class="auth-btn" style="background:#444; color:#fff" onclick="startBuy('PRO PACK', 'pro')">PRO (Сложение/Вычитание) - $29</button>
            </div>
            <div id="finalActions" class="final-btns">
                <button class="auth-btn" onclick="location.reload()">Закрыть</button>
            </div>
        </div>
    </div>

    <!-- Модалка Консоли -->
    <div id="devModal" class="modal">
        <div class="modal-content modal-console">
            <span class="close-x" onclick="closeModal('devModal')">&times;</span>
            <div id="devConsole">
                <div style="color:var(--orange)">[System] DevConsole v1.1.0 (Build 2024) loaded.</div>
                <div style="color: #777">Connection: Established via GitHub.</div>
                <div>Введите 'help' для списка команд.</div>
            </div>
            <div class="cmd-line">
                <span class="cmd-prefix">></span>
                <input type="text" class="cmd-input" placeholder="root@calculator:~#" autofocus>
            </div>
        </div>
    </div>

    <div class="footer-text">calculator.net</div>

    <script>
        /**
         * Calculator.net Dev Edition
         * Основная логика приложения
         */
        
        let currentTier = "none";
        let displayElement = document.getElementById('display');
        let sessionLogs = [];

        // Управление модальными окнами
        function openModal(modalId) {
            console.log("Opening modal: " + modalId);
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            console.log("Closing modal: " + modalId);
            document.getElementById(modalId).style.display = 'none';
        }

        // Логика авторизации
        function fakeLogin() {
            const emailValue = document.getElementById('emailInp').value;
            const passValue = document.getElementById('passInp').value;

            if(!emailValue || !emailValue.includes('@')) {
                alert('Ошибка: Некорректный адрес электронной почты.');
                return;
            }

            if(passValue.length < 4) {
                alert('Ошибка: Пароль слишком короткий.');
                return;
            }
            
            // Скрытие элементов входа и показ профиля
            document.getElementById('loginBtn').style.display = 'none';
            document.getElementById('profileBox').style.display = 'block';
            document.getElementById('devBtn').style.display = 'block';
            
            document.getElementById('pEmail').innerText = emailValue;
            document.getElementById('pName').innerText = emailValue.split('@')[0];
            
            closeModal('loginModal');
            
            // Стандартный доступ после входа
            unlockTier('standart');
            addToLog("User logged in as: " + emailValue);
        }

        // Система разблокировки уровней (Tiers)
        function unlockTier(tierName) {
            currentTier = tierName;
            const label = document.getElementById('statusLabel');
            label.innerText = "Тариф: " + tierName.toUpperCase();
            
            if(tierName === 'mega') label.style.color = 'var(--orange)';

            const allButtons = document.querySelectorAll('.calc-btn');
            allButtons.forEach(button => {
                const btnTier = button.getAttribute('data-tier');
                
                // Простая логика иерархии тарифов
                let isAccessible = false;
                if(tierName === 'mega') isAccessible = true;
                else if(tierName === 'super' && (btnTier === 'super' || btnTier === 'pro' || btnTier === 'standart')) isAccessible = true;
                else if(tierName === 'pro' && (btnTier === 'pro' || btnTier === 'standart')) isAccessible = true;
                else if(tierName === 'standart' && btnTier === 'standart') isAccessible = true;

                if(isAccessible) {
                    button.classList.add('unlocked');
                    button.style.opacity = "1";
                }
            });
            addToLog("Tier changed to: " + tierName);
        }

        // Основной обработчик нажатий калькулятора
        function press(keyValue) {
            const targetBtn = event.target;
            
            // Если кнопка заблокирована
            if(!targetBtn.classList.contains('unlocked')) {
                console.warn("Access denied for key: " + keyValue);
                targetBtn.classList.add('shake');
                setTimeout(() => targetBtn.classList.remove('shake'), 300);
                return;
            }

            // Выполнение операций
            if(keyValue === 'C') {
                displayElement.value = '';
            } 
            else if(keyValue === 'del') {
                displayElement.value = displayElement.value.slice(0, -1);
            }
            else if(keyValue === 'equal') {
                performCalculation();
            }
            else if(keyValue === 'perc') {
                displayElement.value = parseFloat(displayElement.value) / 100;
            }
            else {
                if(displayElement.value === '0' || displayElement.value === 'Error') {
                    displayElement.value = '';
                }
                
                let symbol = keyValue;
                if(keyValue === 'mul') symbol = '×';
                if(keyValue === 'div') symbol = '÷';
                if(keyValue === 'dot') symbol = '.';
                if(keyValue === 'add') symbol = '+';
                if(keyValue === 'sub') symbol = '-';
                
                displayElement.value += symbol;
            }
        }

        // Функция вычисления (Eval с защитой)
        function performCalculation() {
            try {
                let expression = displayElement.value.replace(/×/g, '*').replace(/÷/g, '/');
                if(!expression) return;
                
                let result = eval(expression);
                displayElement.value = Number.isInteger(result) ? result : result.toFixed(4);
                addToLog("Calculation: " + expression + " = " + result);
            } catch (e) {
                displayElement.value = 'Error';
                addToLog("Calculation Error: " + e.message);
            }
        }

        // Логика процесса покупки
        function startBuy(packageName, tierKey) {
            document.getElementById('tierList').style.display = 'none';
            const statusIndicator = document.getElementById('procZone');
            
            statusIndicator.innerHTML = `Инициализация платежа...<br><span style="font-size:12px; color:#555">Package: ${packageName}</span>`;
            
            setTimeout(() => {
                statusIndicator.innerHTML = `Проверка транзакции через шлюз...<br><span class="dots"></span>`;
                setTimeout(() => {
                    statusIndicator.innerHTML = `<span style="color:var(--green); font-weight:bold">ТРАНЗАКЦИЯ ПОДТВЕРЖДЕНА!</span><br>Обновление лицензии...`;
                    setTimeout(() => {
                        unlockTier(tierKey);
                        statusIndicator.innerHTML = `Пакет <b>${packageName}</b> успешно активирован.`;
                        document.getElementById('finalActions').style.display = 'flex';
                    }, 1000);
                }, 2500);
            }, 1500);
        }

        // --- МОДУЛЬ КОНСОЛИ РАЗРАБОТЧИКА ---
        const inputControl = document.querySelector('.cmd-input');
        const consoleOutput = document.getElementById('devConsole');

        if(inputControl) {
            inputControl.addEventListener('keydown', function(eventArgs) {
                if (eventArgs.key === 'Enter') {
                    const rawInput = this.value.trim();
                    const cleanCommand = rawInput.toLowerCase();
                    
                    // Эхо команды
                    const echo = document.createElement('div');
                    echo.innerHTML = `<span style="color:var(--orange)">[guest@dev ~]$</span> ${rawInput}`;
                    consoleOutput.appendChild(echo);

                    // Роутинг команд
                    processCommand(cleanCommand);

                    this.value = '';
                    consoleOutput.scrollTop = consoleOutput.scrollHeight;
                }
            });
        }

        function processCommand(cmd) {
            switch(cmd) {
                case 'site':
                    const repoUrl = "https://github.com";
                    writeToConsole("Redirecting to source repository...", "var(--green)");
                    setTimeout(() => { window.open(repoUrl, '_blank'); }, 800);
                    break;
                
                case 'help':
                    writeToConsole("Доступные системные вызовы:");
                    writeToConsole(" - site: Открыть GitHub проекта");
                    writeToConsole(" - unlock_all: Сброс лицензионных ограничений");
                    writeToConsole(" - status: Текущее состояние системы");
                    writeToConsole(" - clear: Очистить буфер консоли");
                    writeToConsole(" - logs: Показать историю операций");
                    break;

                case 'unlock_all':
                    unlockTier('mega');
                    writeToConsole("CRITICAL: License check bypassed. Mode: GOD_MODE", "var(--red)");
                    break;

                case 'status':
                    writeToConsole("System Status: Operational");
                    writeToConsole("User Tier: " + currentTier.toUpperCase());
                    writeToConsole("Memory Usage: 42MB / 128MB");
                    break;

                case 'clear':
                    consoleOutput.innerHTML = '<div style="color:var(--gray)">Console buffer reset.</div>';
                    break;
                
                case 'logs':
                    writeToConsole("--- Recent Activity ---");
                    sessionLogs.forEach(l => writeToConsole(l, "#888"));
                    break;

                case '':
                    break;

                default:
                    writeToConsole("Command not recognized: " + cmd, "var(--red)");
            }
        }

        function writeToConsole(message, textColor = "white") {
            const lineNode = document.createElement('div');
            lineNode.style.color = textColor;
            lineNode.style.marginTop = "2px";
            lineNode.innerText = ">> " + message;
            consoleOutput.appendChild(lineNode);
        }

        function addToLog(msg) {
            const time = new Date().toLocaleTimeString();
            sessionLogs.push(`[${time}] ${msg}`);
            if(sessionLogs.length > 20) sessionLogs.shift();
        }

        function toggleAuth() {
            const head = document.getElementById('authTitle');
            head.innerText = head.innerText === 'Авторизация' ? 'Регистрация' : 'Авторизация';
            writeToConsole("Auth mode toggled.");
        }
        
        // Автоматический фокус на дисплей (для красоты)
        console.log("Calculator.net Core Initialized.");
    </script>
</body>
</html>
